## 6.2. 메타 키워드

메타 설정은 Suricata의 검토(Suricata 이벤트 리포트)에 영향을 미치지 않는다.

### 6.2.1. msg (message)

`msg` 키워드는 가능한 알람과 표현식에 대한 문자적인 정보를 준다.
msg의 형식은:

```
msg: "some description";
msg: "ATTACK-RESPONSES 403 Forbidden";
msg: "ET EXPLOIT SMB-DS DCERPC PnP bind attempt";
```

To continue the example of the previous chapter, this is the keyword in action in an actual rule:
이전 챕터의 예제를 계속해서 보면, msg 키워드는 실제 규칙에서 동작으로 사용된다.

> drop tcp $HOME_NET any -> $EXTERNAL_NET any (`msg:”ET TROJAN Likely Bot Nick in IRC (USA +..)”`; flow:established,to_server; flowbits:isset,is_proto_irc; content:”NICK “; pcre:”/NICK .*USA.*[0-9]{3,}/i”; reference:url,doc.emergingthreats.net/2008124; classtype:trojan-activity; sid:2008124; rev:2;)

** Convention ** </br>
- 표현식의 첫 분을 대문자로 만들고 표현식의 클래스를 표시한다.
- msg는 표현식의 첫번째 키워드이다.

** note ** </br>
- `;`, `\`, `"` 와 같은 문자들은 msg 내에서 반드시 예외 처리가 되어야한다.

### 6.2.2. sid (signature ID)

`sid`는 모든 서명의 소유자 id를 알려준다. 이 id는 숫자로 구성되어 있다.

sid의 형식은:
```
sid:123;
```

** Convention ** </br>
- `sid`키워드는 표현식의 마지막 (`rev` 키워드가 있다면 마지막에서 두번째) 키워드로 제공되어진다.

### 6.2.3. rev(revision)

`sid` 키워드는 매 순간 `rev`를 동반한다. `rev`는 표현식의 버전을 의미한다. 만약 표현식이 변경되었다면, 작성자로부터 `rev` 숫자가 올라갈 것이다.

rev의 형식은 :

```
rev:123;
```

** Convention ** </br>
`sid` 키워드는 rev 전에 오고, 이 두개는 모든 표현식의 가장 마지막에 위치한다.

### 6.2.4. gid (group ID)

`gid` 키워드는 표현식의 다른 id(sid 같은) 값의 다른 그룹이 주는 것을 사용할 수 있게 해준다. Suricata는 기본적으로 gid 1을 사용한다. 이것은 변경 가능하다. 
보편적이지 않지만 gid는 변경가능하며, 기술적인 영향을 끼치지 않는다. 경고에 알림만 줄 수 있다.

[1:2008124:2] 부분에 fast.log.의 경고에 있는 gid의 예시로, 1은 gid (2008124는 sid이고 2는 rev)이다.

### 6.2.5. classtype

```
config classification: web-application-attack,Web Application Attack,1
config classification: not-suspicious,Not Suspicious Traffic,3
```

|classtype|Alert|Priority|
|web-application-attack|Web Application Attack|1|
|not-suspicious|Not Suspicious Traffic|3|

** Convention ** </br>

### 6.2.6. reference

```
reference: type, reference
```

```
reference: url, www.info.com
```

```
reference: cve, CVE-2014-1234
```

> drop tcp $HOME_NET any -> $EXTERNAL_NET any (msg:”ET TROJAN Likely Bot Nick in IRC (USA +..)”; flow:established,to_server; flowbits:isset,is_proto_irc; content:”NICK “; pcre:”/NICK .*USA.*[0-9]{3,}/i”; `reference:url,doc.emergingthreats.net/2008124`; classtype:trojan-activity; sid:2008124; rev:2;)

### 6.2.7. priority

```
priority:1;
```

### 6.2.8. metadata

```
metadata: key value;
metadata: key value, key value;
```

### 6.2.9. target

```
target:[src_ip|dest_ip]
```
